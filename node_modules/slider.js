function init() {
    ul = document.getElementById('image_slider');
    liItems = ul.children;
    imageNumber = liItems.length;
    imageWidth = liItems[0].children[0].clientWidth;
    ul.style.width = parseInt(imageWidth * imageNumber) + 'px';
    prev = document.getElementById("prev");
    next = document.getElementById("next")
}

/** clicking prev. If current image is the first image ul slide all */

function onClickPrev() {
    if (currentIamge == 0){
        slideto(imageNumber - 1);
    }
    else {
        slideTo(currentImage - 1)
    }
}

function onClickNext() {
    if (currentImage == imageNumber - 1){
        slideTo(0);
    }
    else {
        slideTo(currentImage + 1);
    }
}

function slideTo(imageToGo){
    var direction;
    var numOfImageToGo = Math.abs(imageToGo - currentImage);
    direction = currentImage > imageToGo ? 1 : -1;
    currentPosition = -1 * currentImage * imageWidth;
    var opts = {
        duration:1000,
        delta:function(p){return p;},
        step:function(delta){
            ul.style.left = parseInt(currentPosition + direction * delta * imageWidth * numOfImageToGo) + 'px';
        },
        callback:function(){currentImage = imageToGo;}  
    };
    animate(opts);
}

function animate(opts){
    var start = new Date;
    var id = setInterval(function(){
        var timePassed = new Date - start;
        var progress = timePassed / opts.duration;
        if (progress > 1){
            progress = 1;
        }
        var delta = opts.delta(progress);
        opts.step(delta);
        if (progress == 1){
            clearInterval(id);
            opts.callback();
         }
    }, opts.delay || 17);
}
window.onload = init;

function generatePager(imageNumber){    
    var pageNumber;
    var pagerDiv = document.getElementById('pager');
    for (i = 0; i < imageNumber; i++){
            var li = document.createElement('li');
        pageNumber = document.createTextNode(parseInt(i + 1));
        li.appendChild(pageNumber);
        pagerDiv.appendChild(li);
        // add event inside a loop, closure issue.
        li.onclick = function(i){
                return function(){
                slideTo(i);
            }
        }(i);
    }
    // style.width can't get width from css sheet.  
    var computedStyle = document.defaultView.getComputedStyle(li, null);
    //border width 1px; offsetWidth = 22; offsetWidth returns a number
    var liWidth = li.offsetWidth;
    // remove px from the string returned. like '5px'-->'5'
    var liMargin = parseInt(computedStyle.margin.replace('px',""));
    // margin on both left and right side.
    pagerDiv.style.width = parseInt((liWidth + liMargin * 2) * imageNumber) + 'px';
    }